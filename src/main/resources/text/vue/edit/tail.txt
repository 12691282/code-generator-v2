        </el-form>
        <span slot="footer" class="dialog-footer">
          <el-button size="small" @click="close">取 消</el-button>
          <el-button type="primary" size="small" @click="save">确 定</el-button>
        </span>
  </el-dialog>
</template>
<script>
export default {
  props: ['dataForm', 'visible'],
  data () {

     var checkCode = (rule, value, callback) => {
        if (!value) {
          return callback(new Error('请填写编码'));
        }
        setTimeout(() => {
          if (!Number.isInteger(value - 0)) {
            callback(new Error('请输入数字值'));
          } else {
            callback();
          }
        }, 500);
      };

    return {
      form: {},
      title:"",
      noticeMsg: "",
      isEditCode:false,
      requestUrl: '',
      rules: {
          code: [
            { required: true, validator: checkCode, trigger: 'blur' }
          ],
          name: [
            { required: true, message: '请填写名称', trigger: 'blur' }
          ]
      }
    };
  },
  watch: {
    visible (newVal) {
      if (newVal) {
        this.form = Object.assign({}, this.dataForm);
        if(this.form.id){
            this.requestUrl = "/url/modify"
            this.title =  "修改"
            this.noticeMsg = "数据修改成功！"
            this.isEditCode = true
        }else{
            this.requestUrl = "/url/add"
            this.title =  "新增"
            this.noticeMsg = "保存成功！"
            this.isEditCode = false
        }
      }
    }
  },
  methods: {
    close () {
      this.$emit('update:visible', false);
    },
    save () {
      this.$refs.form.validate((valid) => {
          if (!valid) return;
          this.$http({
            url: this.$http.adornUrl(this.requestUrl),
            method: 'post',
            data: this.$http.adornData(this.form)
          }).then(({data}) => {
            if (data && data.code === 0) {
              this.$message.success(this.noticeMsg);
              this.$emit('update:visible', false);
              this.$emit('reloadList');
            }else{
              this.$message.error(data.msg);
            }
          })

      });
    }
  }
};
</script>